var app=angular.module("app",["ngMaterial"]);app.service("transactionsService",["$http","$q",function(n,t){this.service=function(e,i,a){var o=t.defer();return setTimeout(function(){n({method:e,url:"http://localhost:3000/"+i,data:a}).then(function(n){o.resolve(n.data)},function(n){o.reject(n.statusText)})},50),o.promise}}]),app.directive("transactionsAdd",function(){return{restrict:"E",replace:!0,scope:!0,templateUrl:"app/components/transactions/add/view.html",require:"^transactionsTable",link:function(n,t,e,i){function a(){var t=!0;return""===n.transaction.description&&(t=!1),0===n.transaction.amount&&(t=!1),t}var o=($(t).find(".transaction-form"),$(t).find(".transaction-sync"));o.hide(),n.transaction={date:"2016-01-03",description:"",accountId:0,categoryId:0,statusId:0,parentId:0,amount:"0"},n.add=function(t){t.preventDefault(),a()&&o.fadeIn().promise().done(function(){i.add(n.transaction).then(function(){o.fadeOut()})})}}}}),app.directive("transactionsEdit",function(){return{restrict:"A",require:"^transactionsTable",scope:!0,link:function(n,t,e,i){var a=$(t).find(".transaction-data"),o=$(t).find(".transaction-edit-trigger"),r=$(t).find(".transaction-edit"),c=$(t).find(".transaction-sync"),s=!1;o.hide(),r.hide(),c.hide(),$(t).bind("mouseover",function(){s||o.fadeIn()}),$(t).bind("mouseleave",function(){s||o.fadeOut()}),$(o).bind("click",function(){a.fadeOut().promise().done(function(){s=!0,r.fadeIn(),o.hide()})}),n.save=function(n,t){t&&t.preventDefault(),r.fadeOut().promise().done(function(){c.fadeIn().promise().done(function(){i.edit(n).then(function(){c.fadeOut().promise().done(function(){a.fadeIn(500).promise().done(function(){s=!1,o.show()})})})})})}}}}),app.directive("transactionsSearch",function(){return{restrict:"E",replace:!0,templateUrl:"app/components/transactions/search/view.html",require:"?transactionsTable",link:function(n,t,e,i){}}}),app.directive("transactionsTable",function(){return{restrict:"E",replace:!0,templateUrl:"app/components/transactions/table/view.html",controller:function(n,t,e){function i(){t.service("GET","categories").then(function(t){n.categories=t}),t.service("GET","status").then(function(t){n.status=t}),t.service("GET","accounts").then(function(t){n.accounts=t}),t.service("GET","transactions").then(function(t){n.headers=["Date","Description","Account","Category","Amount","Balance","Status"],n.transactions=t,n.loading=!1})}function a(i,a,o){var r=e.defer();return t.service(i,a,o).then(function(){t.service("GET","transactions").then(function(t){n.transactions=t,r.resolve()})}),r.promise}n.loading=!0,i(),this.add=function(n){return a("POST","transactions/",n)},this.edit=function(n){return a("PUT","transactions/"+n.id,n)};var o=[];n.checked=function(n){-1!==o.indexOf(n.id)?o.splice(o.indexOf(n.id),1):o.push(n.id)},this["delete"]=function(){var n=e.defer(),t=[];return angular.forEach(o,function(n){t.push(a("DELETE","transactions/"+n))}),e.all(t).then(function(){o=[],n.resolve()}),n.promise}},link:function(n,t,e,i){var a=$(t).find(".transactions.delete .transaction-delete"),o=$(t).find(".transactions.delete .transaction-sync");o.hide(),n["delete"]=function(){a.fadeOut().promise().done(function(){o.fadeIn().promise().done(function(){i["delete"]().then(function(){o.fadeOut().promise().done(function(){a.fadeIn()})})})})}}}});